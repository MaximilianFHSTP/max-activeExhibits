<!doctype html>
<html lang="en">
<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">

    <title>MEETeUX Table</title>
    <style>
        html, body { height: 100%;}

        main {
            height: 100%;
        }

        #requestUser {
            margin: 10px 20px;
        }

        .progressbar {
            width: 95%;
            margin-top: -65px;
            margin-bottom: 25px;
            margin-left: auto;
            margin-right: auto;
            }
            .progressbar .inner {
            height: 40px;
            animation: progressbar-countdown;
            animation-duration: 40s;
            animation-iteration-count: 1;
            animation-fill-mode: forwards;
            animation-play-state: paused;
            animation-timing-function: linear;
        }

        .progressbarhidden {
            width: 95%;
            margin-top: -65px;
            margin-bottom: 25px;
            margin-left: auto;
            margin-right: auto;
            }
            .progressbarhidden .inner {
            height: 40px;
            animation: progressbarhidden-countdown;
            animation-duration: 40s;
            animation-iteration-count: 1;
            animation-fill-mode: forwards;
            animation-play-state: paused;
            animation-timing-function: linear;
        }

        .quest{
            width: 100%;
            margin-right: 15%;
            text-align: center;
            font-family: "VollkornBold";
            font-size: 2.3em;
        }
        .headquest{
            padding: 0 10%;
        }
        .ansA{
            margin-left: 10%;
            overflow: hidden;
        }
        .ansB{
            margin-left: 5%;
            overflow: hidden;
        }
        .ansC{
            margin-left: 10%;
            overflow: hidden;
        }
        .ansD{
            margin-left: 5%;
            overflow: hidden;
        }

        .answerA{
            font-family: "OpenSansSemiBold";
            font-size: 1.8em;
            padding-top: 2%;
            width: 84%;
            float: right;
            
        }
        .answerB{
            font-family: "OpenSansSemiBold";
            font-size: 1.8em;
            padding-top: 2%;
            width: 87%;
            float: right;
        }
        .answerC{
            font-family: "OpenSansSemiBold";
            font-size: 1.8em;
            padding-top: 2%;
            width: 84%;
            float: right;
        }
        .answerD{
            font-family: "OpenSansSemiBold";
            font-size: 1.8em;
            padding-top: 2%;
            width: 87%;
            float: right;
        }

        .capAns{
            font-family: 'VollkornBold';
            font-size: 3em;
            color: #755300;
            width: 10%;
            float: left;
        }

        .ansLeft{
            float: left;
            width: 42%;
            margin-left: 10%
        }
        .ansRight{
            float: right;
            width: 45%;
            margin-right: 3%;
        }
        .disabled{
            display: none;
        }
        .enabled{
            display: inline-block;
        }
        .ansSum{
            padding-left: 40%;
            margin-top: -56px;
            color: white;
            font-family: 'OpenSansSemiBold'
        }
        .ansSumText{
            padding-left: 25%;
            color: white;
            font-family: 'OpenSansSemiBold'
        }

        @keyframes progressbarhidden-countdown {
            0% {
                width: 100%;
                background: rgba(144, 110, 27, 0.5);
            }
            100% {
                width: 0%;
                background: rgba(144, 110, 27, 0.5);
            }
        }

        @keyframes progressbar-countdown {
            0% {
                width: 100%;
                background: #906e1b;
            }
            100% {
                width: 0%;
                background: #906e1b;
            }
        }

        .contentContainer{
            margin-top: 2%;
            margin-left: 25%;
            margin-bottom: 2%;
            width: 450px;
            height: 500px;
        }

        .screenLeft{
            padding-top: 2%;
            float:left; 
            width: 49%;
        }

        .screenRight{
            padding: 20px;
            float:right; 
            width: 49.2%;
            height: 100%; 
            background-color: #d3c5a4;
        }

        .progressbarWhiteback{
            outline: solid 5px #755300;
            width: 95%;
            height: 40px;
            margin: 25px auto;
            background: white;
        }

        .bottominfo{
            height: 70px;
            width: 100%;
            position: absolute;
            bottom: 0;
            background-color: #755300;
        }

        .infoleft{
            color: white;
            float:left;
            width:50%;
            margin-top: 15px;
            margin-left: 50px;
            font-family: "OpenSansRegular";
            font-size: 1.5em;
        }

        .inforight{
            position: relative;
            color: white;
            float:right;
            margin-top: 15px;
            margin-right: 65px;
            font-family: "OpenSansRegular";
            font-size: 1.5em;
        }

        .bottomicon{
            position: absolute;
            bottom: 0;
            left: 43.5%;
        }

        .screenDivider{
            width: 1.8%;
            height: 100%; 
            float: left;
            background-color: #755300;
        }

        @font-face {
            font-family: "OpenSansRegular";
            src:url("assets/fonts/OpenSans-Regular.ttf");
        }

        @font-face {
            font-family: "OpenSansBold";
            src:url("assets/fonts/OpenSans-Bold.ttf");
        }

        @font-face {
            font-family: "OpenSansSemiBold";
            src:url("assets/fonts/OpenSans-SemiBold.ttf");
        }

        @font-face {
            font-family: "VollkornRegular";
            src:url("assets/fonts/Vollkorn-Regular.ttf");
        }

        @font-face {
            font-family: "VollkornBold";
            src:url("assets/fonts/Vollkorn-Bold.ttf");
        }

        @font-face {
            font-family: "VollkornSemiBold";
            src:url("assets/fonts/Vollkorn-SemiBold.ttf");
        }

        .bars{
            margin-bottom: 5%;
            height: 50%;
        }
        
        .whitebars{
            margin-left: 10%;
            width: 90%;
            overflow: hidden;
        }

        .barA{
            height: 428px;
            width: 150px;
            margin-right: 3%;
            float: left;
            position: relative;
        }

        .barB{
            height: 428px;
            width: 150px;
            margin-right: 3%;
            float: left;
            position: relative;
        }

        .barC{
            height: 428px;
            width: 150px;
            margin-right: 3%;
            float: left;
            position: relative;
        }

        .barD{
            height: 428px;
            width: 150px;
            margin-right: 3%;
            float: left;
            position: relative;
        }

        .whitebar{
            background-color: white;
            height: 360px;
            width: 110px;
            margin: 0 auto;
        }

        .corAns{
            font-family: 'OpenSansSemiBold';
            font-size: 2em;
            text-align: center;
        }
        .elab{
            margin-left: 10%; 
            margin-right: 10%;
            font-family: 'OpenSansSemiBold';
            font-size: 1.4em;
        }

        .answerBoard{
            height: 60px;
            width: 150px;
            background-color: #755300;
            margin-top: -270px;
        }

        .barSocket{
            height: 60px;
            width: 150px;
            background-color: white;
        }

        .lineSocket{
            height: 8px;
            width: 150px;
            background-color: #906e1b;
            margin-top: 218px;
        }

        .fontSocket{
            color: #755300;
            font-size: 3em;
            font-family: 'VollkornBold';
            margin-top: -62px;
            margin-left: 38%;
        }

        .startBarLine{
            height: 20px;
            width: 86.9%;
            background-color: #906e1b;
            margin-top: 20px;
            margin-left: 2.75%;
        }

        .endBarLine{
            height: 20px;
            width: 92.4%;
            background-color: #906e1b;
            margin-top: 428px;
        }

        .solution{
            margin-top: 8%;
        }

        .percentageBox{
            width: 110px;
            height: 75px;
            margin-left: auto;
            margin-right: auto;
            margin-top: -375px;   
        }

        .percentage{
            text-align: center;
            color: #755300;
            font-size: 1.2em;
            font-family: 'OpenSansBold';
        }

        .percentext{
            text-align: center;
            color: #755300;
            font-size: 1em;
            font-family: 'OpenSansSemiBold';
        }

        .linePercentage{
            height: 8px;
            width: 110px;
            background-color: #755300;
            margin-top: 3px;
        }

        .percentageBarWrapper{
            width: 110px;
            height: 210px;
            -webkit-transform: rotate(180deg);
            -moz-transform: rotate(180deg);
            -o-transform: rotate(180deg);
            -ms-transform: rotate(180deg);
            transform: rotate(180deg);
        }

        .percentageBar{
            background-color: #755300;
            animation: bargrowth 10s ease;
        }

        @-webkit-keyframes bargrowth{
            0%   {max-height: 0%;}
            100%  {max-height: 100%;}
        }
        @keyframes bargrowth{
            0%   {max-height: 0%;}
            100%  {max-height: 100%;}
        }
        /*circle {
        fill: orange;
        }*/
    </style>
</head>
<body>
<main>
    <div style="width: 100%; height: 100%; overflow:auto;">
        <div class='screenLeft'>
            <div class='headquest'><h4 class='quest' id='question'></h4></div>
            <div id='contentImage' class='contentContainer'></div>
            <div class='ansLeft'>
                <div class='ansA' id='ansABlock'><div class='capAns'>A </div><div class='answerA' id='answerA'></div></div>
                <div class='ansC' id='ansCBlock'><div class='capAns'>C </div><div class='answerC' id='answerC'></div></div>
            </div>
            <div class='ansRight'>
                <div class='ansB' id='ansBBlock'><div class='capAns'>B </div><div class='answerB' id='answerB'></div></div>
                <div class='ansD' id='ansDBlock'><div class='capAns'>D </div><div class='answerD' id='answerD'></div></div>
            </div>
        </div>
        <div class='screenDivider'>

        </div>
        <div class='screenRight'>
            <div class='progressbarWhiteback'></div>
            <div id='progressbar'></div>
            
            <div class='bars'>
                <div class='whitebars'>
                    <div class='startBarLine'></div>
                    <div class='barA' id='barA'>
                        <div class='whitebar'></div>
                        <div id="answerBoardA">
                            <div class='answerBoard'></div>
                            <div class='ansSum' id='answerSumA'></div>
                            <div class='ansSumText'>Antworten</div>
                        </div>
                        <div class='lineSocket'></div>
                        <div class='barSocket'></div>
                        <div class='fontSocket'>A</div>
                        <div class='percentageBox' id='percentageBoxA'>
                            <div class='percentage' id='percentageA'>34%</div>
                            <div class='percentext'>aller</div>
                            <div class='percentext'>Antworten</div>
                            <div class='linePercentage'></div>
                            <div class='percentageBarWrapper' id='percentageBarWrapperA'></div>
                        </div>
                    </div>
                    <div class='barB' id='barB'>
                        <div class='whitebar'></div>
                        <div id="answerBoardB">
                            <div class='answerBoard'></div>
                            <div class='ansSum' id='answerSumB'></div>
                            <div class='ansSumText'>Antworten</div>
                        </div>
                        <div class='lineSocket'></div>
                        <div class='barSocket'></div>
                        <div class='fontSocket'>B</div>
                        <div class='percentageBox' id='percentageBoxB'>
                            <div class='percentage' id='percentageB'>34%</div>
                            <div class='percentext'>aller</div>
                            <div class='percentext'>Antworten</div>
                            <div class='linePercentage'></div>
                            <div class='percentageBarWrapper' id='percentageBarWrapperB'></div>
                        </div>
                    </div>
                    <div class='barC' id='barC'>
                        <div class='whitebar'></div>
                        <div id="answerBoardC">
                            <div class='answerBoard'></div>
                            <div class='ansSum' id='answerSumC'></div>
                            <div class='ansSumText'>Antworten</div>
                        </div>
                        <div class='lineSocket'></div>
                        <div class='barSocket'></div>
                        <div class='fontSocket'>C</div>
                        <div class='percentageBox' id='percentageBoxC'>
                            <div class='percentage' id='percentageC'>34%</div>
                            <div class='percentext'>aller</div>
                            <div class='percentext'>Antworten</div>
                            <div class='linePercentage'></div>
                            <div class='percentageBarWrapper' id='percentageBarWrapperC'></div>
                        </div>
                    </div>
                    <div class='barD' id='barD'>
                        <div class='whitebar'></div>
                        <div id="answerBoardD">
                            <div class='answerBoard'></div>
                            <div class='ansSum' id='answerSumD'></div>
                            <div class='ansSumText'>Antworten</div>
                        </div>
                        <div class='lineSocket'></div>
                        <div class='barSocket'></div>
                        <div class='fontSocket'>D</div>
                        <div class='percentageBox' id='percentageBoxD'>
                            <div class='percentage' id='percentageD'>34%</div>
                            <div class='percentext'>aller</div>
                            <div class='percentext'>Antworten</div>
                            <div class='linePercentage'></div>
                            <div class='percentageBarWrapper' id='percentageBarWrapperD'></div>
                        </div>
                    </div>
                    <div class='endBarLine'></div>
                </div>
            </div>
            <div class='solution'>
                <div class='corAns'><span id='correctAns'></span></div>
                <div class='elab'><span id='elaboration'></span></div>
            </div>
        </div>
        <div class='bottominfo'>
            <div class='infoleft'>Bitte App oder stationäres Tablet zur Teilnahme verwenden!</div>
            <div class='bottomicon' id='bottomicon'></div>
            <div class='inforight'>Use your smartphone or the stationary tablet to participate!</div>
        </div>
    </div>
</main>


<!-- Optional JavaScript -->
<!-- jQuery first, then Popper.js, then Bootstrap JS -->
<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>


<script src="https://cdnjs.cloudflare.com/ajax/libs/d3/4.2.2/d3.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/2.0.3/socket.io.js"></script>
<script>
    const socket = io.connect('http://localhost:8100');

    var contentPic;

    var isInPause = false;

    var answerSumA = 0;
    var answerSumB = 0;
    var answerSumC = 0;
    var answerSumD = 0;

    var currentQuestionID;

    var correctAnswer;
    var elaborationTextGer;
    var elaborationTextEng;

    socket.emit('connectClient');

    socket.on('connectClientResult', function(data) {
        socket.emit('requestData');
    });

    socket.on('getAnswerResult', function(data) {
        let userAnsA = data.answerA;
        let userAnsB = data.answerB;
        let userAnsC = data.answerC;
        let userAnsD = data.answerD;

        if(userAnsA){
            answerSumA = answerSumA + 1;
        }else if(userAnsB){
            answerSumB = answerSumB + 1;
        }else if(userAnsC){
            answerSumC = answerSumC + 1;
        }else if(userAnsD){
            answerSumD = answerSumD + 1;
        }else{
            console.log('noAnswerUpdate');
        }
        updateAnswerSums();
    });

    const requestUserButton = $("#requestUser");

    function triggerRequestData(){
        socket.emit('requestData');
    }

    requestUserButton.click(function() {
        triggerRequestData();
    });

    function triggerKick(id){
        socket.emit('kickUser', id);
    }

    function createProgressbar(id, duration, pause, callback) {
        var progressbar = document.getElementById(id);
        var durationTime = duration;
        if(!pause){
            progressbar.className = 'progressbar';
        }else{
            progressbar.className = 'progressbarhidden';
            durationTime = '30s';
        }

        var progressbarinner = document.createElement('div');
        progressbarinner.id = 'timerbar';
        progressbarinner.className = 'inner';

        progressbarinner.style.animationDuration = durationTime;

        if (typeof(callback) === 'function') {
            progressbarinner.addEventListener('animationend', callback);
        }

        progressbar.appendChild(progressbarinner);

        progressbarinner.style.animationPlayState = 'running';

        // createProgressbar(id, duration, callback);
    }

    addEventListener('load', function() {
        answerSumA = 0;
        answerSumB = 0;
        answerSumC = 0;
        answerSumD = 0;

        let bottomContainer = document.getElementById('bottomicon');
        var bottomImg = document.createElement("IMG");
        bottomImg.src = '/assets/icons/circle-icon-cut.png';
        bottomImg.style.height = '160px';
        bottomContainer.appendChild(bottomImg);

        socket.emit('getNextQuestion');
        updateAnswerSums();
        createProgressbar('progressbar', '30s', isInPause, function() {
            isInPause = !isInPause;
            changeQuestionAndRestartTimer();
        });
    });

    function changeQuestionAndRestartTimer(){
        //updateQuestions();
        document.getElementById('timerbar').remove();
        createProgressbar('progressbar', '30s', isInPause, function() {
            isInPause = !isInPause;
            if(!isInPause){
                answerSumA = 0;
                answerSumB = 0;
                answerSumC = 0;
                answerSumD = 0;
                updateAnswerSums();
                let percentageBarA = document.getElementById('percentageBarA');
                let percentageBarB = document.getElementById('percentageBarB');
                let percentageBarC = document.getElementById('percentageBarC');
                let percentageBarD = document.getElementById('percentageBarD');
                percentageBarA.remove();
                percentageBarB.remove();
                percentageBarC.remove();
                percentageBarD.remove();
                socket.emit('getNextQuestion');
            }else{
                correctAns.className = 'enabled';
                elaboration.className = 'enabled';

                let answerABlock = document.getElementById('ansABlock');
                let answerBBlock = document.getElementById('ansBBlock');
                let answerCBlock = document.getElementById('ansCBlock');
                let answerDBlock = document.getElementById('ansDBlock');

                let barA = document.getElementById('barA');
                let barB = document.getElementById('barB');
                let barC = document.getElementById('barC');
                let barD = document.getElementById('barD');

                if(correctAnswer==='A'){
                    answerBBlock.style.opacity = 0.5;
                    answerCBlock.style.opacity = 0.5;
                    answerDBlock.style.opacity = 0.5;
                    barB.style.opacity = 0.5;
                    barC.style.opacity = 0.5;
                    barD.style.opacity = 0.5;
                }else if(correctAnswer==='B'){
                    answerABlock.style.opacity = 0.5;
                    answerCBlock.style.opacity = 0.5;
                    answerDBlock.style.opacity = 0.5;
                    barA.style.opacity = 0.5;
                    barC.style.opacity = 0.5;
                    barD.style.opacity = 0.5;
                }else if(correctAnswer==='C'){
                    answerABlock.style.opacity = 0.5;
                    answerBBlock.style.opacity = 0.5;
                    answerDBlock.style.opacity = 0.5;
                    barA.style.opacity = 0.5;
                    barB.style.opacity = 0.5;
                    barD.style.opacity = 0.5;
                }else if(correctAnswer==='D'){
                    answerABlock.style.opacity = 0.5;
                    answerBBlock.style.opacity = 0.5;
                    answerCBlock.style.opacity = 0.5;
                    barA.style.opacity = 0.5;
                    barB.style.opacity = 0.5;
                    barC.style.opacity = 0.5;
                }

                let percentageBoxA = document.getElementById('percentageBoxA');
                let percentageBoxB = document.getElementById('percentageBoxB');
                let percentageBoxC = document.getElementById('percentageBoxC');
                let percentageBoxD = document.getElementById('percentageBoxD');
                percentageBoxA.style.visibility = "visible";
                percentageBoxB.style.visibility = "visible";
                percentageBoxC.style.visibility = "visible";
                percentageBoxD.style.visibility = "visible";

                let answerBoardA = document.getElementById('answerBoardA');
                let answerBoardB = document.getElementById('answerBoardB');
                let answerBoardC = document.getElementById('answerBoardC');
                let answerBoardD = document.getElementById('answerBoardD');
                answerBoardA.style.visibility = "hidden";
                answerBoardB.style.visibility = "hidden";
                answerBoardC.style.visibility = "hidden";
                answerBoardD.style.visibility = "hidden";

                data = {questionId: currentQuestionID, answerCountA: answerSumA, answerCountB: answerSumB, answerCountC: answerSumC, answerCountD: answerSumD};
                socket.emit('updateAnsweredQuestions', data);
                sendUpdateUser();
                changeQuestionAndRestartTimer();
            }
        });
    }

    function updateAnswerSums(){
        let answerSumAEl = document.getElementById('answerSumA');
        let answerSumBEl = document.getElementById('answerSumB');
        let answerSumCEl = document.getElementById('answerSumC');
        let answerSumDEl = document.getElementById('answerSumD');

        answerSumAEl.innerHTML = '+ '+answerSumA;
        answerSumBEl.innerHTML = '+ '+answerSumB;
        answerSumCEl.innerHTML = '+ '+answerSumC;
        answerSumDEl.innerHTML = '+ '+answerSumD;
    }

    socket.on('getNextQuestionResult', function(data) {
        currentQuestionID = data.id;
        let percentageBoxA = document.getElementById('percentageBoxA');
        let percentageBoxB = document.getElementById('percentageBoxB');
        let percentageBoxC = document.getElementById('percentageBoxC');
        let percentageBoxD = document.getElementById('percentageBoxD');
        let answerBoardA = document.getElementById('answerBoardA');
        let answerBoardB = document.getElementById('answerBoardB');
        let answerBoardC = document.getElementById('answerBoardC');
        let answerBoardD = document.getElementById('answerBoardD');
        let question = document.getElementById('question');
        let elaboration = document.getElementById('elaboration');
        let correctAns = document.getElementById('correctAns');
        let answerA = document.getElementById('answerA');
        let answerB = document.getElementById('answerB');
        let answerC = document.getElementById('answerC');
        let answerD = document.getElementById('answerD');
        let barA = document.getElementById('barA');
        let barB = document.getElementById('barB');
        let barC = document.getElementById('barC');
        let barD = document.getElementById('barD');

        question.innerHTML = data.textGer;
        elaboration.innerHTML = data.elaborationGer;
        elaborationTextGer = data.elaborationGer;
        elaborationTextEng = data.elaborationEng;
        var contentContainer = document.getElementById('contentImage');
        const contentUrl = data.content;
        contentContainer.style.backgroundImage = "url("+contentUrl+")";
        contentContainer.style.backgroundSize = "contain";

        answerBoardA.style.visibility = "visible";
        answerBoardB.style.visibility = "visible";
        answerBoardC.style.visibility = "visible";
        answerBoardD.style.visibility = "visible";
        percentageBoxA.style.visibility = "hidden";
        percentageBoxB.style.visibility = "hidden";
        percentageBoxC.style.visibility = "hidden";
        percentageBoxD.style.visibility = "hidden";

        answerA.innerHTML = data.answers[0].textGer;
        answerB.innerHTML = data.answers[1].textGer;
        answerC.innerHTML = data.answers[2].textGer;
        answerD.innerHTML = data.answers[3].textGer;

        let answerABlock = document.getElementById('ansABlock');
        let answerBBlock = document.getElementById('ansBBlock');
        let answerCBlock = document.getElementById('ansCBlock');
        let answerDBlock = document.getElementById('ansDBlock');

        answerABlock.style.opacity = 1;
        answerBBlock.style.opacity = 1;
        answerCBlock.style.opacity = 1;
        answerDBlock.style.opacity = 1;
        barA.style.opacity = 1;
        barB.style.opacity = 1;
        barC.style.opacity = 1;
        barD.style.opacity = 1;


        if(data.answers[0].isCorrectAnswer){
            correctAnswer = 'A';
            correctAns.innerHTML = 'Richtige Antwort: A';
        }else if(data.answers[1].isCorrectAnswer){
            correctAnswer = 'B';
            correctAns.innerHTML = 'Richtige Antwort: B';
        }else if(data.answers[2].isCorrectAnswer){
            correctAnswer = 'C';
            correctAns.innerHTML = 'Richtige Antwort: C';
        }else if(data.answers[3].isCorrectAnswer){
            correctAnswer = 'D';
            correctAns.innerHTML = 'Richtige Antwort: D';
        }

        correctAns.className = 'disabled';
        elaboration.className = 'disabled';
        const message = {questionId: data.id, questionGer: data.textGer, answerAGer: data.answers[0].textGer, answerBGer: data.answers[1].textGer, answerCGer: data.answers[2].textGer, answerDGer: data.answers[3].textGer, 
            questionEng: data.textGer, answerAEng: data.answers[0].textEng, answerBEng: data.answers[1].textEng, answerCEng: data.answers[2].textEng, answerDEng: data.answers[3].textEng, correctAnswer: correctAnswer};
        socket.emit('getQuestion', message);
        changeQuestionAndRestartTimer();
    });

    socket.on('updateAnsweredQuestionsResult', function(data){
        var answerSumComplete = data.answers[0].numberOfAnsweredTimes+data.answers[1].numberOfAnsweredTimes+data.answers[2].numberOfAnsweredTimes+data.answers[3].numberOfAnsweredTimes;
        if(data.answers[0].numberOfAnsweredTimes===0){
            var percentageA = 0;
        }else{
            var percentageA = data.answers[0].numberOfAnsweredTimes/answerSumComplete*100;
        }
        if(data.answers[1].numberOfAnsweredTimes===0){
            var percentageB = 0;
        }else{
            var percentageB = data.answers[1].numberOfAnsweredTimes/answerSumComplete*100;
        }
        if(data.answers[2].numberOfAnsweredTimes===0){
            var percentageC = 0;
        }else{
            var percentageC = data.answers[2].numberOfAnsweredTimes/answerSumComplete*100;
        }
        if(data.answers[3].numberOfAnsweredTimes===0){
            var percentageD = 0;
        }else{
            var percentageD = data.answers[3].numberOfAnsweredTimes/answerSumComplete*100;
        }

        let percentageAText = document.getElementById('percentageA');
        let percentageBText = document.getElementById('percentageB');
        let percentageCText = document.getElementById('percentageC');
        let percentageDText = document.getElementById('percentageD');
        percentageAText.innerHTML = percentageA + ' %';
        percentageBText.innerHTML = percentageB + ' %';
        percentageCText.innerHTML = percentageC + ' %';
        percentageDText.innerHTML = percentageD + ' %';

        let percentageBarWrapperA = document.getElementById('percentageBarWrapperA');
        var percentageBar = document.createElement('div');
        percentageBar.id = 'percentageBarA';
        percentageBar.className = 'percentageBar';
        percentageBar.style.height= 210*(percentageA/100)+"px";
        percentageBarWrapperA.appendChild(percentageBar);

        let percentageBarWrapperB = document.getElementById('percentageBarWrapperB');
        var percentageBar = document.createElement('div');
        percentageBar.id = 'percentageBarB';
        percentageBar.className = 'percentageBar';
        percentageBar.style.height= 210*(percentageB/100)+"px";
        percentageBarWrapperB.appendChild(percentageBar);

        let percentageBarWrapperC = document.getElementById('percentageBarWrapperC');
        var percentageBar = document.createElement('div');
        percentageBar.id = 'percentageBarC';
        percentageBar.className = 'percentageBar';
        percentageBar.style.height= 210*(percentageC/100)+"px";
        percentageBarWrapperC.appendChild(percentageBar);

        let percentageBarWrapperD = document.getElementById('percentageBarWrapperD');
        var percentageBar = document.createElement('div');
        percentageBar.id = 'percentageBarD';
        percentageBar.className = 'percentageBar';
        percentageBar.style.height= 210*(percentageD/100)+"px";
        percentageBarWrapperD.appendChild(percentageBar);


    });

    function sendUpdateUser(){
        Data = {correctAnswer: correctAnswer, elaborationGer: elaborationTextGer, elaborationEng: elaborationTextEng};
        socket.emit('sendUpdateODData', Data);
    }

    
    //Balls
    /*var width = 300, height = 300
    var nodes = [{}, {}, {}, {}, {}]
    var xCenter = [500, 500, 500]

    var simulation = d3.forceSimulation(nodes)
    .force('charge', d3.forceManyBody())
    simulation.force('x', d3.forceX().x(function(d) {
        return xCenter[d.category];
    }))
    .force('collision', d3.forceCollide().radius(function(d) {
        return d.radius;
    }))
    .on('tick', ticked);

    function ticked() {
    var u = d3.select('svg')
        .selectAll('circle')
        .data(nodes)

    u.enter()
        .append('circle')
        .attr('r', 5)
        .merge(u)
        .attr('cx', function(d) {
        return d.x
        })
        .attr('cy', function(d) {
        return d.y
        })

    u.exit().remove()
    }*/
   
</script>
</body>
</html>